(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();//! МОДАЛЬНОЕ ОКНО АВТОРИЗАЦИИ
const b=document.querySelector("#modal_window"),E=document.querySelector("#loginInput"),p=document.querySelector("#passwordInput"),L=document.querySelector("#loginBtn"),N=document.querySelector("#errorMsg");//! Блок интерфейса, пока не введены правильные данные
document.body.style.overflow="hidden";//! Проверка логина и пароля
function x(){const e=E.value.trim(),t=p.value.trim();e.toLowerCase()==="admin"&&t==="meat1515"?(b.style.display="none",document.body.style.overflow="auto"):(N.textContent="Неверный логин или пароль",p.value="")}//! При клике на кнопку "Войти"
L.addEventListener("click",x);//! При нажатии Enter
b.addEventListener("keydown",e=>{e.key==="Enter"&&x()});//! Кнопки
const C=document.querySelector("#addBtn"),B=document.querySelector("#saleBtn");//! Вес для добавления и продаж
const S=document.querySelector("#addValue"),w=document.querySelector("#saleValue");//! Таблица остатков
const l=document.querySelector("#balance"),M=document.querySelector("#summary");//! Ревизия
const V=document.querySelector("#revisionBtn"),h=document.querySelector("#revisionValue");let u="",d="",q=0,m="";//! Открыть/Закрыть кастомный селектор
function f(e){const t=document.querySelector(e),o=t.querySelector(".custom_select"),c=t.querySelector(".select_option");o.addEventListener("click",()=>{c.style.display=c.style.display=="block"?"none":"block"}),document.addEventListener("click",n=>{t.contains(n.target)||(c.style.display="none")})}f("#addMeat");f("#saleMeat");f("#revisionMeat");//! Настройка селекторов выбора позиции в разных блоках
function v(e,t){const o=document.querySelector(e),c=o.querySelector(".custom_select .selected");o.querySelectorAll(".select_option li").forEach(r=>{r.addEventListener("click",()=>{c.textContent=r.textContent;const i=String(r.dataset.value),a=Number(r.dataset.loss);t==="add"?(d=i,q=a):t==="sale"?m=i:t==="revision"&&(u=i);const s=r.closest(".select_option");s.style.display="none"})})}v("#addMeat","add");v("#saleMeat","sale");v("#revisionMeat","revision");function y(e){const t=l.querySelector(`div[data-value="${e}"]`);if(!t)return null;const o=t.nextElementSibling,c=o?.nextElementSibling,n=c?.nextElementSibling;return{nameDiv:t,weightDiv:o,priceDiv:c,sumDiv:n}}function O(e,t){const o=e*t/100;return e-o}function D(){let e=0;l.querySelectorAll("div[data-value]").forEach(o=>{const c=o.nextElementSibling,n=c.nextElementSibling,r=n.nextElementSibling,i=Number(c.textContent),a=Number(n.textContent),s=i*a;r.textContent=s.toFixed(2),e+=s}),M.textContent=`Итоговая сумма: ${e.toFixed(2)} ₽`}V.addEventListener("click",()=>{const e=Number(h.value);if(!u)return alert("Выберите позицию для ревизии.");if(isNaN(e)||e<0)return alert("Введите корректный остаток.");const t=y(u);if(!t||!t.weightDiv)return alert("Позиция не найдена.");t.weightDiv.textContent=e.toFixed(2),h.value="",g()});function k(){const e=[];l.querySelectorAll("div").forEach(t=>e.push(t.textContent||"")),localStorage.setItem("balanceData",JSON.stringify(e))}function F(){const e=localStorage.getItem("balanceData");if(!e)return;const t=JSON.parse(e),o=l.querySelectorAll("div");t.forEach((c,n)=>{o[n]&&(o[n].textContent=c)})}function g(){D(),k()}C.addEventListener("click",()=>{const e=Number(S.value);if(!d)return alert("Выберите позицию для добавления.");if(!e||e<=0)return alert("Введите корректный вес.");const t=O(e,q),o=y(d);if(!o||!o.weightDiv)return alert("Позиция не найдена.");const c=Number(o.weightDiv.textContent);o.weightDiv.textContent=(c+t).toFixed(2),S.value="",g()});B.addEventListener("click",()=>{const e=Number(w.value);if(!m)return alert("Выберите позицию для продажи.");if(!e||e<=0)return alert("Введите корректный вес продажи.");const t=y(m);if(!t||!t.weightDiv)return alert("Позиция не найдена.");const o=Number(t.weightDiv.textContent);if(e>o)return alert("Недостаточно остатка!");t.weightDiv.textContent=(o-e).toFixed(2),w.value="",g()});F();D();

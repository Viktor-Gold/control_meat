(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();//! МОДАЛЬНОЕ ОКНО АВТОРИЗАЦИИ
const v=document.querySelector("#modal_window"),q=document.querySelector("#loginInput"),m=document.querySelector("#passwordInput"),E=document.querySelector("#loginBtn"),D=document.querySelector("#errorMsg");//! Блок интерфейса, пока не введены правильные данные
document.body.style.overflow="hidden";//! Проверка логина и пароля
function g(){const e=q.value.trim(),t=m.value.trim();e=="admin"||e=="Admin"&&t=="77777777"?(v.style.display="none",document.body.style.overflow="auto"):(D.textContent="Неверный логин или пароль",m.value="")}//! При клике на кнопку "Войти"
E.addEventListener("click",g);//! При нажатии Enter
v.addEventListener("keydown",e=>{e.key==="Enter"&&g()});//! Кнопки
const L=document.querySelector("#addBtn"),C=document.querySelector("#saleBtn");//! Вес для добавления и продаж
const f=document.querySelector("#addValue"),y=document.querySelector("#saleValue");//! Таблица остатков
const i=document.querySelector("#balance"),N=document.querySelector("#summary");let u="",p=0,d="";//! Открыть/Закрыть кастомный селектор
function S(e){const t=document.querySelector(e),o=t.querySelector(".custom_select"),c=t.querySelector(".select_option");o.addEventListener("click",()=>{c.style.display=c.style.display=="block"?"none":"block"}),document.addEventListener("click",n=>{t.contains(n.target)||(c.style.display="none")})}S("#addMeat");S("#saleMeat");//! Настройка селекторов выбора позиции в разных блоках
function h(e,t){const o=document.querySelector(e),c=o.querySelector(".custom_select .selected");o.querySelectorAll(".select_option li").forEach(r=>{r.addEventListener("click",()=>{c.textContent=r.textContent;const l=String(r.dataset.value),a=Number(r.dataset.loss);t=="add"?(u=l,p=a):d=l;const s=r.closest(".select_option");s.style.display="none"})})}h("#addMeat","add");h("#saleMeat","sale");function b(e){const t=i.querySelector(`div[data-value="${e}"]`);if(!t)return null;const o=t.nextElementSibling,c=o?.nextElementSibling,n=c?.nextElementSibling;return{nameDiv:t,weightDiv:o,priceDiv:c,sumDiv:n}}function B(e,t){const o=e*t/100;return e-o}function w(){let e=0;i.querySelectorAll("div[data-value]").forEach(o=>{const c=o.nextElementSibling,n=c.nextElementSibling,r=n.nextElementSibling,l=Number(c.textContent),a=Number(n.textContent),s=l*a;r.textContent=s.toFixed(2),e+=s}),N.textContent=`Итоговая сумма: ${e.toFixed(2)} ₽`}function O(){const e=[];i.querySelectorAll("div").forEach(t=>e.push(t.textContent||"")),localStorage.setItem("balanceData",JSON.stringify(e))}function I(){const e=localStorage.getItem("balanceData");if(!e)return;const t=JSON.parse(e),o=i.querySelectorAll("div");t.forEach((c,n)=>{o[n]&&(o[n].textContent=c)})}function x(){w(),O()}L.addEventListener("click",()=>{const e=Number(f.value);if(!u)return alert("Выберите позицию для добавления.");if(!e||e<=0)return alert("Введите корректный вес.");const t=B(e,p),o=b(u);if(!o||!o.weightDiv)return alert("Позиция не найдена.");const c=Number(o.weightDiv.textContent);o.weightDiv.textContent=(c+t).toFixed(2),f.value="",x()});C.addEventListener("click",()=>{const e=Number(y.value);if(!d)return alert("Выберите позицию для продажи.");if(!e||e<=0)return alert("Введите корректный вес продажи.");const t=b(d);if(!t||!t.weightDiv)return alert("Позиция не найдена.");const o=Number(t.weightDiv.textContent);if(e>o)return alert("Недостаточно остатка!");t.weightDiv.textContent=(o-e).toFixed(2),y.value="",x()});I();w();
